<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é•¿æ±Ÿçç¨€ç‰©ç§çš„ç”Ÿå‘½å›å“</title>
    
    <!-- ğŸš€ æ€§èƒ½ä¼˜åŒ–ï¼šé¢„åŠ è½½å…³é”®èµ„æº -->
    <link rel="preload" as="image" href="bg.png">
    <link rel="preload" as="image" href="title.webp">

    <style>
        /* --- åŸºç¡€è®¾ç½® --- */
        :root {
            --bg-color: #F7F5F0;
            --river-color: #0277BD; 
            --text-primary: #2C3E50;
            --text-secondary: #555;
            --gold: #C5A059;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg-color);
            background-image: radial-gradient(#E0E0E0 1px, transparent 1px);
            background-size: 20px 20px;
            font-family: "Songti SC", "Noto Serif SC", "SimSun", serif;
            color: var(--text-primary);
            overflow-x: hidden;
            padding-bottom: 60px;
        }

        /* --- æç¤ºæ¡† Toast --- */
        .toast {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.85);
            color: #fff;
            padding: 16px 24px;
            border-radius: 8px;
            font-size: 15px;
            z-index: 10001;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            max-width: 80%;
            line-height: 1.5;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .toast.show { opacity: 1; }

        /* --- ç‹¬ç«‹å±‚çº§å®šä¹‰ --- */
        .layer-hero-container {
            position: fixed;
            top: -20%; left: 0; width: 100%; height: 140%; 
            z-index: 0; pointer-events: none; will-change: transform;
        }

        .bg-hero-wrapper {
            position: absolute; top: 14.3%; left: 0; width: 100%; aspect-ratio: 4/3; 
        }

        .bg-hero-img {
            width: 100%; height: 100%;
            background-image: url('bg.png'); 
            background-size: cover; background-position: center; opacity: 0.9;
        }

        .layer-orbs-container {
            position: fixed; top: -20%; left: 0; width: 100%; height: 140%;
            z-index: 1; pointer-events: none; overflow: visible; will-change: transform;
        }

        .orb {
            position: absolute; border-radius: 50%; filter: blur(50px); 
            mix-blend-mode: normal !important; animation: float 10s ease-in-out infinite;
        }

        .orb-1 { width: 300px; height: 300px; background: #5C95E6; opacity: 0.4; top: 5%; left: -50px; animation-duration: 15s; }
        .orb-2 { width: 200px; height: 200px; background: #D4AF37; opacity: 0.4; top: 20%; right: -50px; animation-duration: 12s; }
        .orb-3 { width: 250px; height: 250px; background: #2E8B57; opacity: 0.4; top: 35%; left: 10%; animation-duration: 18s; }
        .orb-4 { width: 280px; height: 280px; background: #5C95E6; opacity: 0.4; top: 55%; right: -20px; animation-duration: 16s; }
        .orb-5 { width: 220px; height: 220px; background: #2E8B57; opacity: 0.4; top: 75%; left: -30px; animation-duration: 14s; }
        .orb-6 { width: 260px; height: 260px; background: #D4AF37; opacity: 0.3; top: 95%; right: 10%; animation-duration: 17s; }
        .orb-7 { width: 300px; height: 300px; background: #5C95E6; opacity: 0.4; top: 115%; left: -40px; animation-duration: 13s; }
        .orb-8 { width: 240px; height: 240px; background: #2E8B57; opacity: 0.4; top: 130%; right: -30px; animation-duration: 19s; }

        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(30px, -30px); }
        }

        header {
            position: relative; z-index: 2; padding: 180px 20px 30px; text-align: center;
        }

        .title-img {
            width: 90%; max-width: 340px; height: auto; margin: 0 auto 20px; display: block;
            animation: fadeInDown 1.2s cubic-bezier(0.22, 1, 0.36, 1);
            filter: drop-shadow(0 4px 10px rgba(0,0,0,0.1));
        }

        .intro-text {
            font-size: 15px; line-height: 1.8; color: var(--text-secondary); text-align: justify;
            max-width: 600px; margin: 0 auto; border: none; padding: 20px 24px;
            background: rgba(255, 255, 255, 0.4); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6); border-radius: 12px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.05); animation: fadeIn 1.5s ease-out;
        }

        .river-container {
            position: relative; width: 100%; max-width: 600px; 
            margin: 20px auto 0; padding-bottom: 20px; overflow: visible; z-index: 2;
        }

        @keyframes breathe-glow {
            0%, 100% { 
                filter: drop-shadow(0 0 2px rgba(2, 119, 189, 0.3)); stroke: #0277BD; stroke-width: 10;
            }
            50% { 
                filter: drop-shadow(0 0 8px rgba(79, 195, 247, 0.8)) drop-shadow(0 0 20px rgba(41, 182, 246, 0.5));
                stroke: #4FC3F7; stroke-width: 13; 
            }
        }
        
        @keyframes point-breathe {
            0%, 100% { border-color: #0277BD; box-shadow: 0 0 15px rgba(2, 119, 189, 0.5); }
            50% { border-color: #4FC3F7; box-shadow: 0 0 25px rgba(79, 195, 247, 0.9); }
        }

        .river-line {
            position: absolute; left: 50%; top: 80px; bottom: 120px; width: 120px; 
            transform: translateX(-50%); background-image: none; z-index: 0; 
        }

        .river-svg {
            width: 100%; height: 100%; overflow: visible; display: block; /* é˜²æ­¢ inline å…ƒç´ å¯¼è‡´çš„é¢å¤–é—´éš™ */
        }

        .river-path {
            fill: none; stroke-linecap: round;
            animation: breathe-glow 2s ease-in-out infinite; will-change: stroke, stroke-width, filter;
        }

        .river-point {
            position: absolute; width: 14px; height: 14px; background: #fff;
            border: 3px solid var(--river-color); border-radius: 50%;
            box-shadow: 0 0 15px rgba(79, 195, 247, 0.8); z-index: 1;
            transform: translate(-50%, -50%); pointer-events: none;
            animation: point-breathe 2s ease-in-out infinite;
        }

        .episode-node {
            position: relative; width: 100%; display: flex; justify-content: center;
            margin-bottom: 40px; z-index: 2; opacity: 0; transform: translateY(50px); 
            transition: opacity 1s ease-out, transform 1s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        .episode-node:nth-child(even) { transition-delay: 0.2s; }
        .episode-node.reveal { opacity: 1; transform: translateY(0); }

        .card {
            width: 88%; max-width: 400px; background: rgba(255, 255, 255, 0.8); 
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border-radius: 16px; box-shadow: 0 10px 40px -10px rgba(31, 38, 135, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.7); text-decoration: none; color: inherit;
            display: block; transition: transform 0.2s, box-shadow 0.2s; overflow: hidden; margin: 0 auto; 
        }
        
        .card:active { transform: scale(0.97); box-shadow: 0 4px 15px rgba(31, 38, 135, 0.08); }
        .card-content { padding: 16px 20px; text-align: left; }
        
        .ep-tag {
            display: flex; align-items: center; justify-content: flex-start; 
            font-size: 12px; color: var(--gold); font-weight: bold; letter-spacing: 1px;
            margin-bottom: 6px; text-shadow: 0 1px 0 rgba(255,255,255,0.8);
        }

        .card-img-wrapper {
            position: relative; width: 100%; padding-top: 56.25%;
            background: rgba(0,0,0,0.05); border-bottom: 1px solid rgba(255,255,255,0.5);
        }
        .card-img {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; transition: opacity 0.5s;
        }
        
        .play-icon {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 44px; height: 44px; background: rgba(255,255,255,0.3); backdrop-filter: blur(4px);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            border: 1px solid rgba(255,255,255,0.8); box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        .play-tri {
            width: 0; height: 0; border-left: 12px solid #fff;
            border-top: 8px solid transparent; border-bottom: 8px solid transparent; margin-left: 4px;
        }
        
        .city { display: block; font-size: 15px; color: var(--river-color); margin-bottom: 4px; font-weight: bold; }
        .title { font-size: 17px; line-height: 1.4; font-weight: bold; color: #1a1a1a; white-space: normal; word-wrap: break-word; }

        .click-ripple {
            position: fixed; border-radius: 50%; background: transparent;
            border: 2px solid rgba(2, 119, 189, 0.8); box-shadow: 0 0 12px rgba(2, 119, 189, 0.5);
            transform: scale(0); pointer-events: none; z-index: 9999;
            animation: ripple-refined 1s cubic-bezier(0.19, 1, 0.22, 1);
        }

        @keyframes ripple-refined {
            0% { transform: scale(0); opacity: 0.8; border-width: 4px; }
            100% { transform: scale(4); opacity: 0; border-width: 0px; }
        }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }

        footer {
            position: relative; z-index: 2; text-align: center; font-size: 12px;
            color: #888; margin-top: 10px; padding: 20px;
        }
    </style>
</head>
<body>

    <div id="toast" class="toast">é“¾æ¥å·²å¤åˆ¶ï¼<br>è¯·åœ¨å¾®ä¿¡ä¸­ç²˜è´´å¹¶ç‚¹å‡»è§‚çœ‹</div>

    <div class="layer-hero-container">
        <div class="bg-hero-wrapper"><div class="bg-hero-img"></div></div>
    </div>

    <div class="layer-orbs-container">
        <div class="orb orb-1"></div><div class="orb orb-2"></div><div class="orb orb-3"></div>
        <div class="orb orb-4"></div><div class="orb orb-5"></div><div class="orb orb-6"></div>
        <div class="orb orb-7"></div><div class="orb orb-8"></div>
    </div>

    <header>
        <img src="title.webp" alt="é•¿æ±Ÿçç¨€ç‰©ç§çš„ç”Ÿå‘½å›å“" class="title-img" fetchpriority="high" onerror="this.style.display='none'; document.getElementById('fb-title').style.display='block'">
        <h1 id="fb-title" style="display:none; color:#2E5C55; margin-bottom:10px;">é•¿æ±Ÿçç¨€ç‰©ç§çš„ç”Ÿå‘½å›å“</h1>
        <div class="intro-text">
            ã€Šé•¿æ±Ÿçç¨€ç‰©ç§çš„ç”Ÿå‘½å›å“ã€‹è®°å½•äº†åœ¨â€œå…±æŠ“å¤§ä¿æŠ¤ã€ä¸æå¤§å¼€å‘â€çš„ç†å¿µæŒ‡å¼•ä¸‹ï¼Œé•¿æ±Ÿæ²¿çº¿åŸå¸‚ä¸ºçç¨€ç‰©ç§é‡å»ºå®¶å›­ã€å®ˆæŠ¤ç”Ÿå‘½ç«ç§çš„è¡ŒåŠ¨ã€‚
            <br><br>
            è¯¥ç‰‡èšç„¦é•¿æ±Ÿä¸Šä¸­ä¸‹æ¸¸çš„11ä¸ªå…¸å‹çç¨€ç‰©ç§â€”â€”å¦‚éº‹é¹¿ã€æ±Ÿè±šã€ä¸­åé²Ÿç­‰ï¼Œé€šè¿‡è®²è¿°å®ƒä»¬ä»æ¿’å±åˆ°ç§ç¾¤æ¢å¤çš„æ•…äº‹ï¼ŒæŠ˜å°„å‡ºäººä¸è‡ªç„¶å…³ç³»çš„é‡å¡‘ã€‚
        </div>
    </header>

    <div class="river-container" id="timeline">
        <div class="river-line" id="river-line-container">
            <!-- SVG å°†é€šè¿‡ JS æ’å…¥ -->
        </div>
    </div>

    <footer><p>ç‚¹å‡»å•é›†è·³è½¬å¾®ä¿¡æ’­æ”¾</p></footer>

    <script>
        const isWeChat = /MicroMessenger/i.test(navigator.userAgent);
        const episodes = [
            { id: 1, city: "æ˜Œéƒ½", title: "å®ˆæŠ¤â€œé›ªå±±ç²¾çµâ€", link: "https://weixin.qq.com/sph/Ai4HdY5Wc" },
            { id: 2, city: "å®œå®¾", title: "éåŒâ€œé²Ÿâ€å¸¸", link: "https://weixin.qq.com/sph/AHkCTuZRg" },
            { id: 3, city: "é“œä»", title: "æ¢µå‡€å±±çš„â€œç²¾çµâ€", link: "https://weixin.qq.com/sph/AjpUUKBWq" },
            { id: 4, city: "ä¹é¾™å¡", title: "ä»¥æ±Ÿä¸ºä¼´ ä¸é¹­åŒè¡Œ", link: "https://weixin.qq.com/sph/ANESnbn18" },
            { id: 5, city: "ä¸‡å·", title: "â€œè•¨â€å¤„é€¢ç”Ÿ", link: "https://weixin.qq.com/sph/A0zUU0MCn" },
            { id: 6, city: "å®œæ˜Œ", title: "æŠ¤é²Ÿå½’æ±Ÿ", link: "https://weixin.qq.com/sph/AGfT9qA9I" },
            { id: 7, city: "è†å·", title: "é‡å›é•¿æ±Ÿçš„éº‹é¹¿", link: "https://weixin.qq.com/sph/AATPxVkb0" },
            { id: 8, city: "é•¿æ²™", title: "æ¹˜æ±Ÿå†è§â€œä¸€æŠ¹çº¢â€", link: "https://weixin.qq.com/sph/ApHR8sKxp" },
            { id: 9, city: "èµ£å·", title: "åœ¨ä¼šæ˜Œæ·±å±±é‡è§è¿ç‰‡â€œæ¤ç‰©ç•Œå¤§ç†ŠçŒ«â€", link: "https://weixin.qq.com/sph/AeIOvO5H5" },
            { id: 10, city: "å®‰åº†", title: "â€œé•¿æ±Ÿå¾®ç¬‘å®ˆæœ›è€…â€<br>â€”â€”ä¸€ä¸ªâ€œè±šçˆ¸â€ä¸æ±Ÿè±šçš„æ•…äº‹", link: "https://weixin.qq.com/sph/Ar75XmGIi" },
            { id: 11, city: "é‡‘å", title: "â€œæ£®æ—å«å£«â€çš„éšç§˜å®¶å›­", link: "https://weixin.qq.com/sph/ACuMKNMlw" },
            { id: 12, city: "æ³°å·", title: "éº‹é€”", link: "https://weixin.qq.com/sph/AN8cGZwmt" }
        ];

        const container = document.getElementById('timeline');

        episodes.forEach((ep) => {
            const node = document.createElement('div');
            node.className = 'episode-node'; 
            node.innerHTML = `
                <a href="${ep.link}" class="card" data-link="${ep.link}">
                    <div class="card-img-wrapper">
                        <img src="${ep.id}.jpg" alt="${ep.title}" class="card-img" loading="lazy">
                        <div class="play-icon"><div class="play-tri"></div></div>
                    </div>
                    <div class="card-content">
                        <div class="ep-tag">EP.${ep.id < 10 ? '0'+ep.id : ep.id}</div>
                        <span class="city">${ep.city}</span>
                        <div class="title">${ep.title.replace(ep.city + 'ï¼š', '')}</div>
                    </div>
                </a>
            `;
            container.appendChild(node);
        });

        function copyToClipboard(text) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                return navigator.clipboard.writeText(text);
            }
            return new Promise((resolve, reject) => {
                try {
                    const textArea = document.createElement("textarea");
                    textArea.value = text;
                    textArea.style.position = "fixed";
                    textArea.style.left = "-9999px";
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    resolve();
                } catch (err) { reject(err); }
            });
        }

        function showToast() {
            const toast = document.getElementById('toast');
            toast.classList.add('show');
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }

        document.querySelectorAll('.card').forEach(card => {
            card.addEventListener('click', function(e) {
                if (isWeChat) return;
                e.preventDefault();
                const link = this.getAttribute('data-link');
                copyToClipboard(link).then(() => {
                    showToast();
                    setTimeout(() => { window.location.href = "weixin://"; }, 1200);
                }).catch(err => {
                    console.error('Copy failed', err);
                    window.location.href = "weixin://";
                });
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            const riverContainer = document.getElementById('river-line-container');
            let path; // å…¨å±€ path å¼•ç”¨
            let pathLength = 0;
            let maxDrawLength = 0;

            // --- æ ¸å¿ƒä¿®å¤ï¼šå°è£…æˆåˆå§‹åŒ–å‡½æ•°ï¼Œæ”¯æŒå¤šæ¬¡è°ƒç”¨ä»¥é€‚åº”å¸ƒå±€å˜åŒ– ---
            function initRiver() {
                // æ¸…ç©ºæ—§å†…å®¹ï¼Œé˜²æ­¢é‡ç»˜æ—¶å åŠ 
                riverContainer.innerHTML = '';

                const height = riverContainer.offsetHeight;
                if (height === 0) return; // å¦‚æœå®¹å™¨é«˜åº¦ä¸º0ï¼Œè¯´æ˜è¿˜æ²¡æ¸²æŸ“å¥½ï¼Œè·³è¿‡

                const width = 120;
                const center = width / 2;
                
                let d = `M ${center} 0`;
                
                const idealWaveHeight = 300; 
                const steps = Math.round(height / idealWaveHeight) || 1;
                const waveHeight = height / steps; // ç¡®ä¿æ•°å­¦ä¸Šå®Œç¾æ•´é™¤

                for (let i = 0; i < steps; i++) {
                    let yStart = i * waveHeight;
                    let amp = 40; 
                    d += ` Q ${center + amp} ${yStart + waveHeight/4} ${center} ${yStart + waveHeight/2}`;
                    d += ` T ${center} ${yStart + waveHeight}`;
                }

                const ns = "http://www.w3.org/2000/svg";
                const svg = document.createElementNS(ns, "svg");
                svg.setAttribute("class", "river-svg");
                svg.setAttribute("viewBox", `0 0 ${width} ${height}`);
                svg.setAttribute("preserveAspectRatio", "none"); 

                path = document.createElementNS(ns, "path");
                path.setAttribute("class", "river-path");
                path.setAttribute("d", d);
                
                svg.appendChild(path);
                riverContainer.appendChild(svg);

                // ç”Ÿæˆå¤´éƒ¨åœ†ç‚¹
                const startDot = document.createElement('div');
                startDot.className = 'river-point';
                startDot.style.left = '50%';
                startDot.style.top = '0%'; 
                riverContainer.appendChild(startDot);

                // ç”Ÿæˆå°¾éƒ¨åœ†ç‚¹
                const endDot = document.createElement('div');
                endDot.className = 'river-point';
                endDot.style.left = '50%';
                endDot.style.top = '100%';
                riverContainer.appendChild(endDot);

                // è®¡ç®—è·¯å¾„é•¿åº¦
                try {
                    pathLength = path.getTotalLength();
                    // é˜²å¾¡æ€§ç¼–ç¨‹ï¼šå¦‚æœç®—å‡ºæ¥æ˜¯0ï¼ˆå¶å‘bugï¼‰ï¼Œç»™ä¸€ä¸ªé»˜è®¤å€¼é˜²æ­¢éšèº«
                    if (pathLength === 0) pathLength = height; 
                } catch(e) {
                    pathLength = height;
                }
                
                path.style.strokeDasharray = pathLength;
                // é‡ç½®åç§»é‡ï¼Œç­‰å¾… updateDraw æ¥ç»˜åˆ¶
                path.style.strokeDashoffset = pathLength;
                
                // å¼ºåˆ¶è§¦å‘ä¸€æ¬¡ç»˜åˆ¶ï¼Œé˜²æ­¢åˆå§‹åŒ–æ—¶æ˜¯ç©ºç™½
                updateDraw();
            }

            // æ‰§è¡Œåˆå§‹åŒ–
            initRiver();

            // --- ç»˜åˆ¶æ›´æ–°é€»è¾‘ ---
            function updateDraw() {
                if (!path || pathLength === 0) return;

                const scrollY = window.scrollY;
                const windowHeight = window.innerHeight;
                const bodyHeight = document.body.offsetHeight;
                const riverTop = riverContainer.getBoundingClientRect().top + scrollY;
                const drawTriggerPoint = scrollY + windowHeight * 0.75; 
                
                let currentDrawLength = drawTriggerPoint - riverTop;

                // å¼ºåˆ¶å®Œæˆé€»è¾‘ï¼šæ¥è¿‘åº•éƒ¨æ—¶ç›´æ¥ç”»æ»¡ï¼Œå®¹é”™ç©ºé—´æ‰©å¤§åˆ° 50px
                if ((window.innerHeight + scrollY) >= bodyHeight - 50) {
                     currentDrawLength = pathLength;
                }

                // è¾¹ç•Œé™åˆ¶
                if (currentDrawLength < 0) currentDrawLength = 0;
                if (currentDrawLength > pathLength) currentDrawLength = pathLength;
                
                // "åªå¢ä¸å‡" é€»è¾‘ï¼Œä½†ä¹Ÿå…è®¸åœ¨é‡æ–°ç”Ÿæˆè·¯å¾„åé‡ç½®
                // è¿™é‡Œçš„å¤„ç†ï¼šå¦‚æœè·¯å¾„å˜çŸ­äº†ï¼ˆæ¯”å¦‚çª—å£ç¼©å°ï¼‰ï¼ŒmaxDrawLength å¯èƒ½ä¼šè¶…å‡ºï¼Œéœ€è¦å–å°å€¼
                if (maxDrawLength > pathLength) maxDrawLength = pathLength;

                if (currentDrawLength > maxDrawLength) {
                    maxDrawLength = currentDrawLength;
                    // ä½¿ç”¨ toFixed é¿å…æå°æ•°ç²¾åº¦çš„ NaN é—®é¢˜
                    path.style.strokeDashoffset = (pathLength - maxDrawLength).toFixed(2);
                }
            }

            // --- äº‹ä»¶ç›‘å¬ ---

            // 1. æ»šåŠ¨ç›‘å¬ (è§†å·® + ç»˜åˆ¶)
            const layerHero = document.querySelector('.layer-hero-container');
            const layerOrbs = document.querySelector('.layer-orbs-container');
            let ticking = false;

            window.addEventListener('scroll', () => {
                if (!ticking) {
                    window.requestAnimationFrame(() => {
                        const scrolled = window.scrollY;
                        // è§†å·®æ›´æ–°
                        if(layerHero) layerHero.style.transform = `translate3d(0, -${scrolled * 0.2}px, 0)`;
                        if(layerOrbs) layerOrbs.style.transform = `translate3d(0, -${scrolled * 0.2}px, 0)`;
                        
                        updateDraw();
                        ticking = false;
                    });
                    ticking = true;
                }
            });

            // 2. çª—å£å¤§å°æ”¹å˜ç›‘å¬ (æ’é›·å…³é”®ï¼šé‡æ–°è®¡ç®—æ²³æµè·¯å¾„)
            let resizeTimeout;
            window.addEventListener('resize', () => {
                // é˜²æŠ–ï¼Œé¿å… resize è¿‡ç¨‹ä¸­é¢‘ç¹é‡ç»˜å¯¼è‡´å¡é¡¿
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    // é‡ç½®ç»˜åˆ¶è¿›åº¦ï¼Œå› ä¸ºè·¯å¾„é•¿åº¦å˜äº†
                    maxDrawLength = 0; 
                    initRiver();
                }, 200);
            });

            // 3. é¡µé¢å®Œå…¨åŠ è½½ç›‘å¬ (æ’é›·å…³é”®ï¼šç¡®ä¿å›¾ç‰‡åŠ è½½æ’‘å¼€é«˜åº¦åï¼Œæ²³æµé‡æ–°é€‚åº”)
            window.addEventListener('load', () => {
                // å›¾ç‰‡åŠ è½½å¯èƒ½å¯¼è‡´å†…å®¹é«˜åº¦å˜åŒ–ï¼Œå†æ¬¡åˆå§‹åŒ–ä»¥åŒ¹é…æœ€ç»ˆé«˜åº¦
                initRiver();
            });

            // --- èŠ‚ç‚¹æ˜¾ç°åŠ¨ç”» ---
            const observer = new IntersectionObserver((entries, obs) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('reveal');
                        obs.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.episode-node').forEach(node => observer.observe(node));
        });

        document.addEventListener('click', function(e) {
            const ripple = document.createElement('div');
            ripple.className = 'click-ripple';
            const size = 20; 
            ripple.style.width = size + 'px';
            ripple.style.height = size + 'px';
            ripple.style.left = (e.clientX - size/2) + 'px';
            ripple.style.top = (e.clientY - size/2) + 'px';
            document.body.appendChild(ripple);
            ripple.addEventListener('animationend', () => ripple.remove());
        });
    </script>
</body>
</html>